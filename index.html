<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Writing Procedural Specs</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
			border-bottom: 3px solid transparent;
			margin-bottom: -3px;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom-color: #054572;
			border-bottom-color: var(--toclink-underline);
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://garykac.github.io/procxpec" rel="canonical">
  <meta content="ba95fb637026d02e5d73808d84e770aa924ee225" name="document-revision">
<style>
code, pre, pre.highlight {
    background-color: #f8f8ff;
}
pre, pre.highlight {
    white-space: pre-wrap;
    border-radius: 10px;
    padding: 10px 20px;
    margin: 1em 0;
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1>Writing Procedural Specs <br><small>...for the Web Platform</small> <br><small>...using Bikeshed</small> </h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2023-09-15">15 September 2023</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:garykac@google.com">Gary Kacmarcik</a> (<a class="p-org org" href="https://google.com">Google</a>)
     <dt>Relying heavily on the expertise of:
     <dd>domenic@, jakearchibald@, jsbell@, ...
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" height="15" src="https://licensebuttons.net/p/zero/1.0/80x15.png" width="80"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 15 September 2023,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document contains a simple overview of common structures in algorithmic web standard specifications, with attention paid to the particular issues associated with Web Platform specifications. The examples are all presented in Bikeshed.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#what-is-a-procedural-spec"><span class="secno">1.1</span> <span class="content">What is a Procedural Spec?</span></a>
      <li><a href="#location"><span class="secno">1.2</span> <span class="content">Location</span></a>
     </ol>
    <li><a href="#processing-model"><span class="secno">2</span> <span class="content">Processing Model</span></a>
    <li>
     <a href="#writing-algorithms"><span class="secno">3</span> <span class="content">Writing Algorithms</span></a>
     <ol class="toc">
      <li><a href="#sequential-algorithm-steps"><span class="secno">3.1</span> <span class="content">Sequential algorithm steps</span></a>
     </ol>
    <li>
     <a href="#writing-idl"><span class="secno">4</span> <span class="content">Writing IDL</span></a>
     <ol class="toc">
      <li><a href="#xmp-for-idl"><span class="secno">4.1</span> <span class="content">Use <code>&lt;xmp></code> for IDL blocks</span></a>
      <li><a href="#domintro"><span class="secno">4.2</span> <span class="content">Adding a domintro</span></a>
      <li><a href="#internal-slots"><span class="secno">4.3</span> <span class="content">Internal Slots</span></a>
     </ol>
    <li>
     <a href="#concept-types-and-objects"><span class="secno">5</span> <span class="content">Concept Types and Objects</span></a>
     <ol class="toc">
      <li><a href="#adjusting-dfn-names"><span class="secno">5.1</span> <span class="content">Adjusting Definition Names</span></a>
      <li><a href="#scoping-definitions"><span class="secno">5.2</span> <span class="content">Scoping Definitions</span></a>
     </ol>
    <li><a href="#local-variables"><span class="secno">6</span> <span class="content">Local variables</span></a>
    <li>
     <a href="#variable-types"><span class="secno">7</span> <span class="content">Variable Types</span></a>
     <ol class="toc">
      <li><a href="#boolean"><span class="secno">7.1</span> <span class="content">Boolean</span></a>
      <li><a href="#string-mutability"><span class="secno">7.2</span> <span class="content">Strings and Mutability</span></a>
     </ol>
    <li><a href="#if-then-else"><span class="secno">8</span> <span class="content">If - Then - Else</span></a>
    <li><a href="#switch"><span class="secno">9</span> <span class="content">Switch</span></a>
    <li><a href="#ternary-operator"><span class="secno">10</span> <span class="content">Ternary Operator</span></a>
    <li><a href="#conditions"><span class="secno">11</span> <span class="content">Conditions</span></a>
    <li><a href="#for-each"><span class="secno">12</span> <span class="content">For Each</span></a>
    <li><a href="#exiting"><span class="secno">13</span> <span class="content">Exiting</span></a>
    <li>
     <a href="#asynchronous-tasks"><span class="secno">14</span> <span class="content">Asynchronous tasks</span></a>
     <ol class="toc">
      <li><a href="#background-thread"><span class="secno">14.1</span> <span class="content">Running on the Background Thread</span></a>
     </ol>
    <li><a href="#promises"><span class="secno">15</span> <span class="content">Promises</span></a>
    <li><a href="#defining-functions"><span class="secno">16</span> <span class="content">Defining Functions</span></a>
    <li><a href="#calling-functions"><span class="secno">17</span> <span class="content">Calling Functions</span></a>
    <li>
     <a href="#global-objects"><span class="secno">18</span> <span class="content">Global Objects</span></a>
     <ol class="toc">
      <li><a href="#user-agent"><span class="secno">18.1</span> <span class="content">User Agent</span></a>
      <li><a href="#browsing-context"><span class="secno">18.2</span> <span class="content">Browsing Context (aka, a "tab" in the browser)</span></a>
      <li><a href="#window-navigator"><span class="secno">18.3</span> <span class="content">Window/Navigator</span></a>
      <li><a href="#document"><span class="secno">18.4</span> <span class="content">Document</span></a>
      <li><a href="#document-browsing-context"><span class="secno">18.5</span> <span class="content">Document with a Browsing Context</span></a>
     </ol>
    <li><a href="#service-workers"><span class="secno">19</span> <span class="content">ServiceWorkers</span></a>
    <li><a href="#domintro-css"><span class="secno"></span> <span class="content">Appendix A - CSS for domintro</span></a>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p class="note" role="note"><span class="marker">NOTE:</span> This document is mostly a collection of notes that I started making while wading into the procedural
spec writing process. It does not currently cover everything, but rather only those things that I’ve bumped into so far.
It’s written as a set of recommendations, even though this is not official documentation.</p>
   <p>If you’re just getting started with Bikeshed, you might find Daniel LaLiberte’s <a href="https://dlaliberte.github.io/bikeshed-intro/">Introduction to Writing Specifications with Bikeshed</a> document to be a useful resource.</p>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="what-is-a-procedural-spec"><span class="secno">1.1. </span><span class="content">What is a Procedural Spec?</span><a class="self-link" href="#what-is-a-procedural-spec"></a></h3>
   <p>The recent call for "procedural specs" is basically asking for spec to be more specific and
detailed (e.g, by including pseudo code algorithms and explicitly specifying each step).
It came about as a reaction to the fairly loose style that had become prevalent in specs.</p>
   <p>Exclusively relying on the more informal style (where specs are mostly prose) sometimes led
to situations where the behavior looked like it was well-specified, but inadvertently omitted
important details. This, coupled with a lack of good tests, led at times to well-intentioned
implementors creating incompatible versions of a feature (for example, the <code>KeyboardEvent</code>’s <code>keyCode</code> and <code>charCode</code> attributes).</p>
   <p>Of course, most specifications fall on the spectrum between these two extremes. Specifications
will typically be some combination of informal prose (often non-normative) and more formal
algorithms. The spec editor should use judgement to balance the need for readability vs.
the need for specificity and consider the role that proper tests play in the specification
process.</p>
   <h3 class="heading settled" data-level="1.2" id="location"><span class="secno">1.2. </span><span class="content">Location</span><a class="self-link" href="#location"></a></h3>
   <p>Because this document is an amalgam of information about procedural specs, the Web Platform
and Bikeshed, some of the information might be more properly located in other locations:</p>
   <ul>
    <li data-md>
     <p><a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org</a>, for algorithms and procedural spec writing</p>
    <li data-md>
     <p><a href="https://tabatkins.github.io/bikeshed/">Bikeshed documentation</a>, for information relating to using Bikeshed</p>
    <li data-md>
     <p>Various Web Platform specs, for information about how to use defined objects in other specifications</p>
   </ul>
   <p>It’s possible that some information presented here will move into other locations in the future.</p>
   <h2 class="heading settled" data-level="2" id="processing-model"><span class="secno">2. </span><span class="content">Processing Model</span><a class="self-link" href="#processing-model"></a></h2>
   <p>Many procedural specifications deal with data passing from script into some browser function where it is processed, and then some output is returned back into script. For both specifications and browser implementations, it is important to understand how different languages participate in this.</p>
   <p>A typical browser implementation interacts with script as follows:</p>
   <ol>
    <li data-md>
     <p>A <em>script engine</em> executes a line of JavaScript code.</p>
    <li data-md>
     <p>A <em>bindings layer</em> translates this into a call on an internal object (generally C++ or Rust), translating the input types from script to internal types.</p>
    <li data-md>
     <p>If the input is not valid, the <em>script engine</em> is told to throw an exception.</p>
    <li data-md>
     <p>Otherwise, the <em>implementation</em> processes the input and returns the output.</p>
    <li data-md>
     <p>The <em>bindings layer</em> translates that output from internal types into a JavaScript result.</p>
    <li data-md>
     <p>Execution continues in the <em>script engine</em> with the result.</p>
   </ol>
   <p>Specifications define the required <em>implementation</em> behavior using abstract concepts so that they can be written in any programming language (C++, Rust, etc). The language for those abstract concepts is defined by <a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[Infra]</a>. This includes <a href="https://infra.spec.whatwg.org/#algorithms">algorithms</a>, <a href="https://infra.spec.whatwg.org/#primitive-data-types">primitive data types</a> such as numbers and strings, and <a href="https://infra.spec.whatwg.org/#data-structures">data structures</a> such as lists and maps.</p>
   <p>The work of the <em>bindings layer</em> is defined by <a data-link-type="biblio" href="#biblio-webidl" title="Web IDL Standard">[WebIDL]</a>, which specifies how to translate JavaScript values into Infra types and back. Therefore, when writing a specification, you craft the Web IDL to define the API that JavaScript interacts with, but you write procedures in terms of Infra algorithms and types.</p>
   <p>Notes:</p>
   <ul>
    <li data-md>
     <p>Outside of Web IDL fragments, specification text only needs to describe the behavior of the fourth step in the list above. Web IDL takes care of ensuring that an implementation is not presented with incorrect types.</p>
    <li data-md>
     <p>Algorithms that operate on objects defined by Web IDL interfaces—either the "this" object or those passed as an argument—do reference the type named in Web IDL (e.g. <code>HTMLElement</code>). But it is important to note that they do not interact with it in the same way that script does; for example, they do not access properties or call methods on them.</p>
    <li data-md>
     <p>Non-interface Web IDL types have some surprising subtlety:</p>
     <ul>
      <li data-md>
       <p>Enumerations are expressed in script simply as strings. Web IDL guarantees that implementations only need to consider valid members.</p>
      <li data-md>
       <p>Dictionaries are typically expressed in script as object literals. Web IDL defines the very rigorous steps in which the properties of these objects are inspected and extracted, and implementations only interact with the dictionary as an Infra <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">ordered map</a>.</p>
      <li data-md>
       <p>Sequences are expressed in script as arrays or iterables. Web IDL converts these to <a data-link-type="dfn" href="https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-list-and-record-specification-type" id="ref-for-sec-list-and-record-specification-type">lists</a>.</p>
     </ul>
    <li data-md>
     <p>Wherever possible, link from your specification text to terms in Infra: types, such as <a data-link-type="dfn" href="https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-list-and-record-specification-type" id="ref-for-sec-list-and-record-specification-type①">lists</a>, properties such as <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a>, and operations such as <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">append</a>. This helps avoid ambiguity about the procedure you are defining, and helps you as the author think in terms of the types.</p>
   </ul>
   <p class="note" role="note"><span class="marker">NOTE:</span> There are exceptional cases where some specifications need to deal directly with JavaScript types or properties of JavaScript objects. This should be a last resort, and done only after very careful consultation with experts. Writing this kind of specification correctly is <em>much</em> trickier than you can imagine.</p>
   <h2 class="heading settled" data-level="3" id="writing-algorithms"><span class="secno">3. </span><span class="content">Writing Algorithms</span><a class="self-link" href="#writing-algorithms"></a></h2>
   <p>Create an algorithm <code>&lt;div></code> to contain your algorithm steps by including an <code>algorithm</code> attribute. This will add nice default styling to make the algorithms easier to read. In most cases, you should use <code>&lt;dfn></code> to create a definition, which will name the algorithm.</p>
<pre>&lt;div algorithm>
  To &lt;dfn>do a thing&lt;/dfn>:

  ...your algorithm steps here...
&lt;/div>
</pre>
   <p>In addition to making the algorithm pretty, Bikeshed will also detect these algorithm
blocks and do a bit of error checking to make sure that you don’t have unused variables
in your algorithm. Learn more about variables below.</p>
   <h3 class="heading settled" data-level="3.1" id="sequential-algorithm-steps"><span class="secno">3.1. </span><span class="content">Sequential algorithm steps</span><a class="self-link" href="#sequential-algorithm-steps"></a></h3>
   <p>All algorithm steps are implicitly sequential and each step must begin with <code>1.</code> so that they are auto-numbered.</p>
<pre>1. step-1
1. step-2
1. step-3
</pre>
   <p>Note that Bikeshed doesn’t require that the lines begin with <code>1.</code>—any number followed by a <code>.</code> will work.
Some spec editors prefer to explicitly number the items 1, 2, 3 to make the Bikeshed source document easier
to read, but the recommendation here is to use <code>1.</code> everywhere to make it easier to insert new steps at the
beginning or middle of the algorithm.</p>
   <h2 class="heading settled" data-level="4" id="writing-idl"><span class="secno">4. </span><span class="content">Writing IDL</span><a class="self-link" href="#writing-idl"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="xmp-for-idl"><span class="secno">4.1. </span><span class="content">Use <code>&lt;xmp></code> for IDL blocks</span><a class="self-link" href="#xmp-for-idl"></a></h3>
   <p>The <code>&lt;xmp></code> tag is a deprecated HTML element that Bikeshed recommends as a replacement
wherever you might want to use the <code>&lt;pre></code> tag.</p>
   <p>Within an <code>&lt;xmp></code> tag, you do not need to HTML-escape <code>&amp;</code> and <code>&lt;</code> characters.</p>
   <p>This is useful for IDL blocks because it means you don’t have to write:</p>
<pre>interface Clipboard : EventTarget {
    Promise&amp;lt;DataTransfer> read();
};
</pre>
   <p>You can write <code>Promise&lt;DataTransfer></code> directly, without escaping the <code>&lt;</code> character.</p>
   <p>See <a href="https://tabatkins.github.io/bikeshed/#xmp">Bikeshed’s xmp documentation</a> for more info.</p>
   <h3 class="heading settled" data-level="4.2" id="domintro"><span class="secno">4.2. </span><span class="content">Adding a domintro</span><a class="self-link" href="#domintro"></a></h3>
   <p>After any IDL block, it is important to include a section with a short, non-normative
description for each property defined in the IDL.
This section, known colloquially as a "domintro", should occur immediately after the IDL
block it describes.</p>
   <p>See <a href="https://html.spec.whatwg.org/multipage/comms.html#the-messageevent-interface">The MessageEvent interface</a> for a good example of this practice.</p>
   <p>These descriptive blocks are especially important for algorithmic specifications because
web developers tend to find the algorithms harder to read (which makes them less accessible).
Note that the descriptions in the domintro section are likely to be extracted from
the specification and include in external documentation (like <a href="https://developer.mozilla.org/en-US/">MDN</a>).</p>
   <p>The suggested markup for a domintro block is as follows:</p>
<pre>&lt;dl class="domintro">
  &lt;dt>&lt;code>property&lt;/code>
  &lt;dd>
    &lt;p>Brief summary of property
&lt;/dl>
</pre>
   <p>The underlying CSS for this may eventually be included in the default stylesheet, but in
the meantime you can copy <a href="#domintro-css">this CSS</a> into your spec.</p>
   <h3 class="heading settled" data-level="4.3" id="internal-slots"><span class="secno">4.3. </span><span class="content">Internal Slots</span><a class="self-link" href="#internal-slots"></a></h3>
   <p>In IDL you define attributes, but in a procedural spec you should refer to "internal slot"s that hold
the raw values associated with those attributes.</p>
   <p>As an example, given the following IDL:</p>
<pre>Interface Television {
    attribute unsigned short channel;
    readonly attribute boolean supportsHighDefinition;
};
</pre>
   <p>A procedural spec would describe this by:</p>
   <p>(1) <strong>defining an "internal slot"</strong> for the channel value:</p>
<pre>A [=television=] has a &lt;dfn for=television>current channel&lt;/dfn> which is a positive integer, initially 3.
</pre>
   <p>(2) specifying that the IDL attribute’s <strong>getter</strong> should return the value in the internal slot:</p>
<pre>The &lt;dfn attribute for=Television>channel&lt;/dfn> IDL attribute’s getter must return the television object’s [=television/current channel=].
</pre>
   <p>(3) specifying that the IDL attribute’s <strong>setter</strong> should update the value in the internal slot (not for readonly attributes!):</p>
<pre>The &lt;dfn attribute for=Television>channel&lt;/dfn> IDL attribute’s setter, given |value|, must set the television object’s [=television/current channel=] to |value|.
</pre>
   <p>(4) making sure that all operations in the spec <strong>refer to the internal slot</strong> rather than the IDL attribute:</p>
<pre>When the + button on the remote is pressed, increase [=television/current channel=] of the associated [=television=] by 1.
</pre>
   <h2 class="heading settled" data-level="5" id="concept-types-and-objects"><span class="secno">5. </span><span class="content">Concept Types and Objects</span><a class="self-link" href="#concept-types-and-objects"></a></h2>
   <p>Types and objects that are required by the algorithm should be described outside the algorithm and should be
presented as a definition, for example:</p>
<pre>The user agent has a &lt;dfn>really useful object&lt;/dfn> that ...
</pre>
   <p>Note that the definition is a short, readable English phrase rather than a variable name (so no camelCase
et al.). These lines are not numbered because they are not part of an algorithm.</p>
   <p>References to this type or object should be wrapped in <code>[=</code> and <code>=]</code> so that they are auto-linked by Bikeshed.</p>
<pre>1. If the [=really useful object=] is null, then …
</pre>
   <p class="note" role="note"><span class="marker">NOTE:</span> You could also wrap types/objects with a simple <code>&lt;a></code> tag and Bikeshed will auto-link that as well,
but the <code>[=square bracket=]</code> notation is easier to read and allows concise use of <code>[=for/term=]</code> for
scoped definitions.</p>
   <h3 class="heading settled" data-level="5.1" id="adjusting-dfn-names"><span class="secno">5.1. </span><span class="content">Adjusting Definition Names</span><a class="self-link" href="#adjusting-dfn-names"></a></h3>
   <p>Sometimes, when referencing these definitions, you’ll want to adjust the name to avoid awkward
grammatical constructions or to make the text read more smoothly.
For example, you may define <code>&lt;dfn>is valid&lt;/dfn></code>, but want to
reference that definition in "The value must be valid".</p>
   <p>This can be accomplished as follows:</p>
<pre>The value must be [=is valid|valid=].
</pre>
   <p>where the desired display text is given at the end, separated by a <code>|</code>.</p>
   <h3 class="heading settled" data-level="5.2" id="scoping-definitions"><span class="secno">5.2. </span><span class="content">Scoping Definitions</span><a class="self-link" href="#scoping-definitions"></a></h3>
   <p>If you are defining a generic term, you may need to scope it to disambiguate it from other uses of the same
term (which may occur if another specification exports that term). Consider the following 2 definitions for
"resolution":</p>
<pre>A [=television=] has a &lt;dfn>resolution&lt;/dfn> that …

Each completed [=action=] has a &lt;dfn>resolution&lt;/dfn> that …
</pre>
   <p>These definitions can be scoped using the "for" attribute:</p>
<pre>A [=television=] has a &lt;dfn for=television>resolution&lt;/dfn> that …

Each completed [=action=] has a &lt;dfn for=action>resolution&lt;/dfn> that …
</pre>
   <p>This allows the definitions to be explicitly referenced using the scope and the term:</p>
<pre>1. If the [=television/resolution=] is "1080p", then …
1. If the [=action/resolution=] is "fail", then …
</pre>
   <p>Note that if you are adding multiple definitions for the same object, you can set a default scope as follows:</p>
<pre>&lt;div dfn-for=television>
    A [=television=] has a &lt;dfn>current channel&lt;/dfn> …
    A [=television=] has a &lt;dfn>resolution&lt;/dfn> …
&lt;/div>
</pre>
   <h2 class="heading settled" data-level="6" id="local-variables"><span class="secno">6. </span><span class="content">Local variables</span><a class="self-link" href="#local-variables"></a></h2>
   <p>When a variable is introduced (usually at the start of the algorithm, but may occur in
the middle), use "let" and surround the variable name with <code>|</code>vertical bars<code>|</code>.</p>
<pre>1. Let |y| be false.
</pre>
   <p>Update already created variables with "set".</p>
<pre>1. Set |x| to null.
</pre>
   <p class="note" role="note"><span class="marker">NOTE:</span> You could also wrap variable names with a <code>&lt;var></code> tag and Bikeshed will recognize that as well,
but the <code>|</code>vertical bar<code>|</code> notation makes the algorithm easier to read.</p>
   <h2 class="heading settled" data-level="7" id="variable-types"><span class="secno">7. </span><span class="content">Variable Types</span><a class="self-link" href="#variable-types"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="boolean"><span class="secno">7.1. </span><span class="content">Boolean</span><a class="self-link" href="#boolean"></a></h3>
   <ul>
    <li data-md>
     <p>To create booleans: "Let |x| be a boolean initially set to true." (or false)</p>
    <li data-md>
     <p>To update booleans: "set" to "true" or "false"</p>
    <li data-md>
     <p>To check booleans: use "is true" or "is false"</p>
   </ul>
   <p class="note" role="note"><span class="marker">NOTE:</span> Many specs use "flags" which you "set" and "clear" and check for being "set" or "not set". Newer specs are starting to use "boolean". Existing specs that use flags may be converted at some point.</p>
   <h3 class="heading settled" data-level="7.2" id="string-mutability"><span class="secno">7.2. </span><span class="content">Strings and Mutability</span><a class="self-link" href="#string-mutability"></a></h3>
   <p>Many specs include steps like:</p>
<pre>1. lowercase x
</pre>
   <p>where <code>x</code> is a string. Note that this implies that <code>x</code> is mutable.
An alternate way of writing this is:</p>
<pre>1. set x to be the result of lowercasing x
</pre>
   <p>which does not assume that <code>x</code> is mutable. To avoid unintended side-effects,
don’t use mutable strings when the scope of the variable extends outside the current
function.</p>
   <p class="note" role="note"><span class="marker">NOTE:</span> See <a href="https://github.com/whatwg/infra/issues/91">whatwg/infra/91</a> for further discussion.</p>
   <h2 class="heading settled" data-level="8" id="if-then-else"><span class="secno">8. </span><span class="content">If - Then - Else</span><a class="self-link" href="#if-then-else"></a></h2>
   <p>Simple "if x then y" constructions can be placed on a single line.</p>
<pre>1. If |x| is "some-value", set |y| to true.
</pre>
   <p>The "else" clause (if present) must be a numbered sibling to the matching "if" clause.</p>
<pre>1. If |x| is "some-value", set |y| to true.
1. Else set |y| to false.
</pre>
   <div class="issue" id="issue-e527b7d7"><a class="self-link" href="#issue-e527b7d7"></a> ISSUE: Resolve "else" vs. "otherwise" (which is used in many specs).  Options include:
(1) Require "else" and "else if";
(2) Require "otherwise" and "otherwise if";
(3) Allow both (but require that the spec must be consistent).
Also, see Ternary Operator for another use of "otherwise".
See <a href="https://github.com/garykac/procspec/issues/9">Issue #9</a>. </div>
   <p>Any number of "else-if" clauses can be added, each one numbered at the same level as the matching "if" (see Switch, below, for another option if you have many "else-if"s).</p>
<pre>1. If |x| is "some-value", set |some-var| to true.
1. Else if |x| is "other-value", set |other-var| to true.
1. Else set |other-other-var| to false.
</pre>
   <p>If multiple actions need to occur, then sub-steps can be specified.</p>
<pre>1. If |x| is "some-value", then:
    1. Set |some-var| to true.
    1. Set |some-other-var| to false.
1. Else if |x| is "other-value", then:
    1. Set |some-var| to false.
    1. Set |some-other-var| to true.
</pre>
   <div class="note" role="note">
     NOTE: You may encounter specifications which refer to running "substeps", for example: 
<pre>1. If |x| is "some-value", run the following substeps:
    1. Set |some-var| to true.
    1. Set |some-other-var| to true.
</pre>
    <p>However, this phrasing is now discouraged in favor of the more concise "then".</p>
   </div>
   <h2 class="heading settled" data-level="9" id="switch"><span class="secno">9. </span><span class="content">Switch</span><a class="self-link" href="#switch"></a></h2>
   <div class="examples"> Spec examples: See <a href="https://w3c.github.io/IndexedDB/#evaluate-a-key-path-on-a-value">IndexedDB</a> </div>
   <p>In some cases it may be more readable to list a set of choices rather than using if/else steps.</p>
<pre>1. Switch on |style| and run the associated steps:
    &lt;dl class=switch>
        &lt;dt>"prose"&lt;/dt>
        &lt;dd>
            1. Append the string "old and busted" to the output.
            1. Return false
        &lt;/dd>

        &lt;dt>"algorithmic"&lt;/dt>
        &lt;dd>
            1. Append the string "new hotness" to the output.
            1. Return true
        &lt;/dd>

        &lt;dt>Otherwise&lt;/dt>
        &lt;dd>
            1. Throw TypeError.
        &lt;/dd>
    &lt;/dl>
</pre>
   <p>The cases can be more complicated than simple values e.g. ranges, referencing lists, etc. In the extreme, conditions can be used as cases where this improves readability over long if/else if/else if steps, e.g.:</p>
<pre>1. Jump to the appropriate steps below:
    &lt;dl class=switch>
        &lt;dt>If |var| is a list and length is greater than 1&lt;/dt>
        &lt;dd>
            ...
        &lt;/dd>

        &lt;dt>If |var| is a list and length is 1&lt;/dt>
        &lt;dd>
            …
        &lt;/dd>

        &lt;dt>If |var| is a string&lt;/dt>
        &lt;dd>
            …
        &lt;/dd>

        &lt;dt>Otherwise&lt;/dt>
        &lt;dd>
            …
        &lt;/dd>
    &lt;/dl>
</pre>
   <p class="note" role="note"><span class="marker">NOTE:</span> In various spec stylesheets, the "switch" class generates ↪ (U+21AA RIGHTWARDS ARROW WITH HOOK) using CSS ::before content.</p>
   <h2 class="heading settled" data-level="10" id="ternary-operator"><span class="secno">10. </span><span class="content">Ternary Operator</span><a class="self-link" href="#ternary-operator"></a></h2>
   <p>The compact ternary operator:</p>
<pre>1. Set |x| to 1 if some-condition, or 2 otherwise.
</pre>
   <h2 class="heading settled" data-level="11" id="conditions"><span class="secno">11. </span><span class="content">Conditions</span><a class="self-link" href="#conditions"></a></h2>
   <p>Boolean conditions</p>
<pre>1. If |var| is true, …
</pre>
   <p>For conditions with complex data types, use "equals" and make sure it is linked to the text that defines equality for that data type. For example, for URLs:</p>
<pre>1. If |thisURL| [=url/equals=] |requestURL|, …
</pre>
   <p class="note" role="note"><span class="marker">NOTE:</span> <code>[=url/equals=]</code> is a Bikeshed shortcut for <code>&lt;a for="url">equals&lt;/a></code>.</p>
   <h2 class="heading settled" data-level="12" id="for-each"><span class="secno">12. </span><span class="content">For Each</span><a class="self-link" href="#for-each"></a></h2>
   <p>Simple "for each" constructions can be placed on a single line.</p>
<pre>1. [=For each=] {{Entry}} |e| in |entry-list|, set |e|'s {{Entry/start}} to 0.
</pre>
   <p>For more complex actions, use a colon and add indented sub-steps.</p>
<pre>1. [=For each=] {{Entry}} |e| in |entry-list|:
    1. Set |e|'s {{Entry/start}} to 0.
    1. Set |e|'s {{Entry/end}} to 0.
</pre>
   <p>To exit the loop prematurely, use "break"/"break out of this loop" (to stop the loop entirely by jumping to the end) or "continue"/"continue to the next item" (to stop this iteration and continue with the next item in the collection).</p>
   <p>As a shortcut for:</p>
<pre>1. [=For each=] |e| in |entry-list|:
    1. If |e|'s {{type}} is "t", set |e|'s {{start}} to 0.
</pre>
   <p>you can use "for each … whose …":</p>
<pre>1. [=For each=] |e| in |entry-list| whose {{type}} is "t", set |e|'s {{start}} to 0.
</pre>
   <h2 class="heading settled" data-level="13" id="exiting"><span class="secno">13. </span><span class="content">Exiting</span><a class="self-link" href="#exiting"></a></h2>
   <p>To exit the entire algorithm:</p>
<pre>1. Abort these steps
</pre>
   <p>or</p>
<pre>1. Return
</pre>
   <p>To exit and return a value from the algorithm:</p>
<pre>1. Return |x|.
</pre>
   <p>To exit by throwing an error:</p>
<pre>1. If Type(|v|) is not an Object, [=throw=] a TypeError
</pre>
   <p>The exit action can be appended to another action.</p>
<pre>1.  Set |x| to false and abort these steps.
</pre>
   <h2 class="heading settled" data-level="14" id="asynchronous-tasks"><span class="secno">14. </span><span class="content">Asynchronous tasks</span><a class="self-link" href="#asynchronous-tasks"></a></h2>
   <p>By default, all algorithms run on the main thread. To run part of the algorithm on a
background thread, use the "in parallel" construction:</p>
<pre>1. Run these steps [=in parallel=]:
    1. step-1
    1. step-2
</pre>
   <p>This indicates that a separate task should be created on the background thread to run the
substeps (step-1 &amp; step-2) in order. This new background task is run in parallel with the
steps on the main thread.</p>
   <div class="note" role="note">
     NOTE: In English, the construction "run these steps in parallel: A, B, C" means
"run A, B and C in parallel with each other". However, in specifications, it has the
specific meaning of running A, B and C sequentially on a background thread (that runs in
parallel with the main thread). 
    <div class="issue" id="issue-01f40d82"><a class="self-link" href="#issue-01f40d82"></a> ISSUE: This construction is rather awkward because it doesn’t match the standard English
meaning of this phrase.
See <a href="https://github.com/garykac/procspec/issues/6">Issue #6</a>. </div>
   </div>
   <h3 class="heading settled" data-level="14.1" id="background-thread"><span class="secno">14.1. </span><span class="content">Running on the Background Thread</span><a class="self-link" href="#background-thread"></a></h3>
   <p>When specifying steps that run on a background thread, there are some restrictions to be aware of:</p>
   <ul>
    <li data-md>
     <p>You cannot update values that are accessible from JS. Any action that needs to be observable from JS must be made on the main thread.</p>
   </ul>
   <p>Background tasks can create other background tasks (using the "in parallel" construction), but to get back onto the main thread, you need to "queue a task".</p>
<pre>1. [=Queue a task=] that runs the following steps:
    1. step-1
    1. step-2
</pre>
   <p>If you need to refer to this task elsewhere, it can be introduced as a local variable.</p>
<pre>[=Queue a task=] |task| that runs the following steps:
    1. step-1
    1. step-2
</pre>
   <p>Elsewhere in the algorithm, to block on this task, use "wait".</p>
<pre>Wait for |task| to have executed.
</pre>
   <h2 class="heading settled" data-level="15" id="promises"><span class="secno">15. </span><span class="content">Promises</span><a class="self-link" href="#promises"></a></h2>
   <p>The proper way to use Promises in specifications is covered in <a href="https://www.w3.org/2001/tag/doc/promises-guide">Writing Promise-Using Specifications</a>.
This sections provides only a brief high-level summary.</p>
   <p>To create a new promise:</p>
<pre>1. Let |promise| be a new [=promise=].
</pre>
   <p>To resolve the promise with a value.</p>
<pre>1. Resolve |promise| with |some-value|.

1. Resolve |promise| with undefined.
</pre>
   <p>To reject a promise, use "reject" with the error.</p>
<pre>1. Reject |promise| with an "AnError" DOMException.
</pre>
   <h2 class="heading settled" data-level="16" id="defining-functions"><span class="secno">16. </span><span class="content">Defining Functions</span><a class="self-link" href="#defining-functions"></a></h2>
   <p>Functions with explicit input and output can be written as follows:</p>
<pre>&lt;dfn>is it really Santa&lt;/dfn>
: Input
::    |name|, a string
::    |isJolly|, a boolean
: Output
::   |isSanta|, a boolean
1. Let |isSanta| be false.
1. If name is "Nick" and |isJolly| is true, set |isSanta| to true.
1. Return |isSanta|.
</pre>
   <p>Sometimes, the function name is written more formally using camelCase or InitialCaps. In this example, that could be something like <em>isReallySanta</em>.</p>
   <p>If there are no input parameters to the function, the entire Input/Output block at the beginning is typically omitted.</p>
   <p>If there is input, but no output, then use "None" for output.</p>
<pre>&lt;dfn>do something&lt;/dfn>
: Input
::    |name|, a string
: Output
::   None
1. Fire an event named "name" at the xyz element.
</pre>
   <h2 class="heading settled" data-level="17" id="calling-functions"><span class="secno">17. </span><span class="content">Calling Functions</span><a class="self-link" href="#calling-functions"></a></h2>
   <p>Functions without parameters are called as follows:</p>
<pre>1. Let |result| be the result of running [=FunctionName=].
</pre>
   <p>Functions with parameters:</p>
<pre>1. Let |result| be the result of running [=FunctionName=] with "Kringle" and true as the arguments.
</pre>
   <p>or</p>
<pre>1. Let |result| be the result of running [=FunctionName=] given "Kringle" and true.
</pre>
   <p>or (naming each argument):</p>
<pre>1. Let |result| be the result of running [=FunctionName=] with |name| as "Kringle" and |isJolly| as true.
</pre>
   <h2 class="heading settled" data-level="18" id="global-objects"><span class="secno">18. </span><span class="content">Global Objects</span><a class="self-link" href="#global-objects"></a></h2>
   <p>For some global Concept Objects, it is important to make sure that they are defined in the appropriate location to ensure that feature works as intended (and so that it is implemented in a compatible way in different implementations).</p>
   <p>Here are some common locations considered for global objects:</p>
   <h3 class="heading settled" data-level="18.1" id="user-agent"><span class="secno">18.1. </span><span class="content">User Agent</span><a class="self-link" href="#user-agent"></a></h3>
   <p>This makes the object the same for the entire browser (across all tabs and web pages). Usually, this is not what you want.</p>
   <h3 class="heading settled" data-level="18.2" id="browsing-context"><span class="secno">18.2. </span><span class="content">Browsing Context (aka, a "tab" in the browser)</span><a class="self-link" href="#browsing-context"></a></h3>
   <p>Placing an object here makes it available to every page that is navigated to within that browsing context, even to cross-origin sites. This is also probably not where you want to place web platform objects.</p>
   <h3 class="heading settled" data-level="18.3" id="window-navigator"><span class="secno">18.3. </span><span class="content">Window/Navigator</span><a class="self-link" href="#window-navigator"></a></h3>
   <p>Window and Navigator have the same observable behavior, so the choice between them is arbitrary. However, it is often easier to write specs that refer to "the navigator’s object xxx" (for Navigator) rather than "the navigator’s object relevant global object’s xxx" (for Window).</p>
   <p>Consider the following scenarios:</p>
   <ul>
    <li data-md>
     <p>Inject into about:blank and then navigate: Objects <strong>are</strong> preserved.</p>
    <li data-md>
     <p>document.open(): Objects <strong>are not</strong> preserved (because the Window is re-created)</p>
   </ul>
   <h3 class="heading settled" data-level="18.4" id="document"><span class="secno">18.4. </span><span class="content">Document</span><a class="self-link" href="#document"></a></h3>
   <p>This gives the object to every document, including those created by document.implementation.createDocument() and the XHR’s <a href="https://xhr.spec.whatwg.org/#response-document-object">response document</a>.</p>
   <p>If your feature is user-facing, then you probably want to use "Document with a Browsing Context" so that the object is not present in those situations.</p>
   <h3 class="heading settled" data-level="18.5" id="document-browsing-context"><span class="secno">18.5. </span><span class="content">Document with a Browsing Context</span><a class="self-link" href="#document-browsing-context"></a></h3>
   <p>This gives the object to every document that is associated with a tab in the browser.</p>
   <p>Consider the following scenarios:</p>
   <ul>
    <li data-md>
     <p>Inject into about:blank and then navigate: Objects <strong>are not</strong> preserved.</p>
    <li data-md>
     <p>document.open(): Objects <strong>are</strong> preserved</p>
   </ul>
   <h2 class="heading settled" data-level="19" id="service-workers"><span class="secno">19. </span><span class="content">ServiceWorkers</span><a class="self-link" href="#service-workers"></a></h2>
   <p><code>Navigator</code> objects that are intended to be available for <code>ServiceWorker</code>s need to be added to <code>ServiceNavigator</code>.
In most cases, this means that the object will need to be added to both <code>Navigator</code> and <code>ServiceNavigator</code>.</p>
   <p>See <a href="https://w3c.github.io/permissions/#navigator-and-workernavigator-extension">this example</a>.</p>
   <p class="issue" id="issue-0e9b749d"><a class="self-link" href="#issue-0e9b749d"></a> Is this section supposed to refer to <code>WorkerNavigator</code> ?</p>
   <h2 class="heading settled" id="domintro-css"><span class="content">Appendix A - CSS for domintro</span><a class="self-link" href="#domintro-css"></a></h2>
   <p>Include this style block near the top of your Bikeshed file (see <a href="https://github.com/domenic/async-local-storage/blob/650bbe92f971dca1fc56f3597c9887c309761a92/spec.bs#L89-L117">Async Local Storage</a> for an example).</p>
<pre>&lt;style>
/* domintro from https://resources.whatwg.org/standard.css */
dl.domintro {
  position: relative;
  color: green;
  background: #DDFFDD;
  margin: 2.5em 0 2em 0;
  padding: 1.5em 1em 0.5em 2em;
}
dl.domintro dt, dl.domintro dt * {
  color: black;
  font-size: inherit;
}
dl.domintro dd {
  margin: 0.5em 0 1em 2em; padding: 0;
}
dl.domintro dd p {
  margin: 0.5em 0;
}
dl.domintro::before {
  content: 'For web developers (non-normative)';
  background: green;
  color: white;
  padding: 0.15em 0.25em;
  font-style: normal;
  position: absolute;
  top: -0.8em;
  left: -0.8em;
}
&lt;/style>
</pre>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
   <dt id="biblio-infra">[Infra]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> ISSUE: Resolve "else" vs. "otherwise" (which is used in many specs).  Options include:
(1) Require "else" and "else if";
(2) Require "otherwise" and "otherwise if";
(3) Allow both (but require that the spec must be consistent).
Also, see Ternary Operator for another use of "otherwise".
See <a href="https://github.com/garykac/procspec/issues/9">Issue #9</a>. <a class="issue-return" href="#issue-e527b7d7" title="Jump to section">↵</a></div>
   <div class="issue"> ISSUE: This construction is rather awkward because it doesn’t match the standard English
meaning of this phrase.
See <a href="https://github.com/garykac/procspec/issues/6">Issue #6</a>. <a class="issue-return" href="#issue-01f40d82" title="Jump to section">↵</a></div>
   <div class="issue"> Is this section supposed to refer to <code>WorkerNavigator</code> ? <a class="issue-return" href="#issue-0e9b749d" title="Jump to section">↵</a></div>
  </div>